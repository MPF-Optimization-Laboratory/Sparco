<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta name="generator" content="jemdoc, see http://jemdoc.jaboc.net/" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="stylesheet" href="style.css" type="text/css" />
<title>Classification problems</title>
</head>
<body>
<table summary="Table for page layout." id="tlayout">
<tr valign="top">
<td id="layout-content">
<div id="toptitle">
<h1>Classification problems</h1>
</div>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>guide_class</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2012-07-17"><meta name="DC.source" content="guide_class.m">
<link rel="stylesheet" type="text/css" href="../../style.css"/>
</head><body><div class="content"><h1></h1><!--introduction--><p>In this example we will see the specificity of the classification problems (<a href="problems.html#prob801">801</a> and <a href="problems.html#prob802">802</a>) and solve one using <a href="http://www.cs.ubc.ca/labs/scl/spgl1">SPGL1</a>.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Generating the problem</a></li><li><a href="#3">Solving the problem</a></li></ul></div><h2>Generating the problem<a name="1"></a></h2><p>We generate the problem of the classification of corrupted images (<a href="problems.html#prob802">problem 802</a>) with the corruption ration <img src="/ubc/cs/home/p/pasjean/Documents/MATLAB/Sparco/documentation/matlab_published/html/guide_class_eq62796.png" alt="$\rho = 0.5$">, the doxn-sampling to <img src="/ubc/cs/home/p/pasjean/Documents/MATLAB/Sparco/documentation/matlab_published/html/guide_class_eq95382.png" alt="$m=800$"> coefficients (instead of 168*192=32256) and <img src="/ubc/cs/home/p/pasjean/Documents/MATLAB/Sparco/documentation/matlab_published/html/guide_class_eq04757.png" alt="$n=16$"> images from each of the 8 sets of the training data to form the dictionary.</p><pre class="codeinput">  P = generateProblem(<span class="string">'classcorr'</span>,<span class="string">'n'</span>,16,<span class="string">'m'</span>,800,<span class="string">'rho'</span>,0.5);
</pre><p>The Dictionary used is a concatenation of the dictionary formed by the training data and the identity matrix to take into account the error created by the corruption :</p><pre class="codeinput">B  = P.B            <span class="comment">% The full dictionary</span>
B1 = B.children{1}  <span class="comment">% The dictionary from the training data</span>
B2 = B.children{2}  <span class="comment">% The identity matrix</span>
</pre><pre class="codeoutput">B = 
  Spot operator: [Matrix(32256,128), Dirac(32256,32256)]
    rows:  32256    complex: no        
    cols:  32384    type:    Dictionary
B1 = 
  Spot operator: Matrix(32256,128)
    rows:  32256    complex: no        
    cols:    128    type:    Matrix    
B2 = 
  Spot operator: Dirac(32256,32256)
    rows:  32256    complex: no        
    cols:  32256    type:    Dirac     
</pre><h2>Solving the problem<a name="3"></a></h2><p>We solve the complex L1 recovery problem : <img src="/ubc/cs/home/p/pasjean/Documents/MATLAB/Sparco/documentation/matlab_published/html/guide_class_eq59442.png" alt="$$ \mbox{min } ||z||_1 \mbox{s.t}  ||[B1 B2]z \left[\begin{array}{c}c \\ e\end{array}\right] - b||_2 <= \sigma$">$</p><pre class="codeinput">  spglopts = spgSetParms(<span class="string">'optTol'</span>,1e-4,<span class="string">'verbosity'</span>,0);
  tau = 0;   <span class="comment">% Initial one-norm of solution</span>
  sigma = 5; <span class="comment">% Go for a basis pursuit solution</span>
  z = spgl1(P.A, P.b, tau, sigma, [], spglopts);

<span class="comment">% Find out from which set the solution is the closest</span>
  n       = (P.B.n-32256) / 8;
  A       = P.A;

  <span class="keyword">for</span> i=1:8
      idx = ((i-1)*n+1):(i*n);
      B   = A(:,idx);
      c   = z(idx,:);
      <span class="keyword">if</span> (i==1)
          sol.min = norm(P.b-B*c,2);
          sol.arg = 1;
      <span class="keyword">else</span>
          <span class="keyword">if</span> norm(P.b-B*c,2) &lt; sol.min
              sol.min = norm(P.b-B*c,2);
              sol.arg = i;
          <span class="keyword">end</span>
      <span class="keyword">end</span>
  <span class="keyword">end</span>

  <span class="comment">% Show a face from the real face set and the found set</span>
  [opts,varg] = sparco.tools.parseDefaultOpts();

  figure;
  subplot(1,3,1);
  imagesc(reshape(P.signal,192,168));
  colormap <span class="string">gray</span>; axis <span class="string">square</span>; title <span class="string">'Initial face'</span>;

  subplot(1,3,2);
  img = imread(sprintf(<span class="string">'%sprob80x_%d_01.pgm'</span>, opts.datapath, sol.arg));
  imagesc(img); title <span class="string">'Face from recovered set'</span>; colormap <span class="string">gray</span>; axis <span class="string">square</span>;

  subplot(1,3,3);
  img = imread(sprintf(<span class="string">'%sprob80x_%d_01.pgm'</span>, opts.datapath, P.x0));
  imagesc(img); title <span class="string">'Face from real set'</span>; colormap <span class="string">gray</span>; axis <span class="string">square</span>;
</pre><img vspace="5" hspace="5" src="/ubc/cs/home/p/pasjean/Documents/MATLAB/Sparco/documentation/matlab_published/html/guide_class_01.png" alt=""> <p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
##### SOURCE BEGIN #####
%%
% In this example we will see the specificity of the classification
% problems (<problems.html#prob801 801> and <problems.html#prob802 802>) and solve
% one using <http://www.cs.ubc.ca/labs/scl/spgl1 SPGL1>.

%% Generating the problem
%
% We generate the problem of the classification of corrupted images (<problems.html#prob802 problem 802>)
% with the corruption ration $\rho = 0.5$, the doxn-sampling to $m=800$ 
% coefficients (instead of 168*192=32256) and $n=16$ images from each of
% the 8 sets of the training data to form the dictionary.

  P = generateProblem('classcorr','n',16,'m',800,'rho',0.5);

%%
% The Dictionary used is a concatenation of the dictionary formed by the
% training data and the identity matrix to take into account the error
% created by the corruption :

B  = P.B            % The full dictionary
B1 = B.children{1}  % The dictionary from the training data
B2 = B.children{2}  % The identity matrix

%% Solving the problem
% We solve the complex L1 recovery problem :
% $$ \mbox{min } ||z||_1 \mbox{s.t}  ||[B1 B2]z \left[\begin{array}{c}c
% \\ e\end{array}\right] - b||_2 <= \sigma$$

  spglopts = spgSetParms('optTol',1e-4,'verbosity',0);
  tau = 0;   % Initial one-norm of solution
  sigma = 5; % Go for a basis pursuit solution
  z = spgl1(P.A, P.b, tau, sigma, [], spglopts);
  
% Find out from which set the solution is the closest
  n       = (P.B.n-32256) / 8;
  A       = P.A;
  
  for i=1:8
      idx = ((i-1)*n+1):(i*n);
      B   = A(:,idx);
      c   = z(idx,:);
      if (i==1)
          sol.min = norm(P.b-B*c,2);
          sol.arg = 1;
      else
          if norm(P.b-B*c,2) < sol.min
              sol.min = norm(P.b-B*c,2);
              sol.arg = i;
          end
      end
  end
  
  % Show a face from the real face set and the found set
  [opts,varg] = sparco.tools.parseDefaultOpts();
  
  figure;
  subplot(1,3,1);
  imagesc(reshape(P.signal,192,168)); 
  colormap gray; axis square; title 'Initial face';
  
  subplot(1,3,2);
  img = imread(sprintf('%sprob80x_%d_01.pgm', opts.datapath, sol.arg));
  imagesc(img); title 'Face from recovered set'; colormap gray; axis square;
  
  subplot(1,3,3);
  img = imread(sprintf('%sprob80x_%d_01.pgm', opts.datapath, P.x0));
  imagesc(img); title 'Face from real set'; colormap gray; axis square;
  
##### SOURCE END #####
--></body></html>




<div id="footer">
<div id="footer-text">
Page last updated on 2012-07-17
</div>
</div>
</td>
<td id="layout-menu">
<div class="menu-category">Sparco</div>
<div class="menu-item"><a href="index.html">Home</a></div>
<div class="menu-item"><a href="credits.html">License&nbsp;&amp;&nbsp;Credits</a></div>
<div class="menu-item"><a href="links.html">Related&nbsp;Links</a></div>
<div class="menu-category">Guides</div>
<div class="menu-item"><a href="generate.html">Generating&nbsp;problems</a></div>
<div class="menu-item"><a href="guide_problem2.html">Problem&nbsp;structure</a></div>
<div class="menu-item"><a href="problems.html">Index&nbsp;of&nbsp;Problems</a></div>
<div class="menu-item"><a href="http://www.cs.ubc.ca/labs/scl/spot/">Spot&rsquo;s&nbsp;Guide</a></div>
<div class="menu-category">Examples</div>
<div class="menu-item"><a href="guide_GPSR2.html">Solving&nbsp;a&nbsp;Sparco&nbsp;problem&nbsp;with&nbsp;GPSR</a></div>
<div class="menu-item"><a href="guide_class2.html" class="current">Classification&nbsp;problems</a></div>
<div class="menu-item"><a href="guide_convolution2.html">Blurring&nbsp;and&nbsp;Deblurring&nbsp;an&nbsp;Image</a></div>
<div class="menu-item"><a href="guide_sparserecovery2.html">Sparse&nbsp;Recovery</a></div>
</td>
</tr>
</table>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4736412-2");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>
